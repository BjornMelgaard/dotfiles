#!/usr/bin/env ruby

# usage:
#
# in branch with name `feature/trace`
# > beautiful-git-commit -m "added something"
# result in commit message
# feature (trace): added something

options = ARGV
message_pointer_index = options.index('-m')

unless message_pointer_index
  puts 'Message is required'
  exit false
end

message = options.delete_at(message_pointer_index + 1)
options.delete_at(message_pointer_index)

branch_name = `git rev-parse --abbrev-ref HEAD`.chomp

if branch_name.include? '/'
  feature, feature_name = branch_name.split('/')

  feature_name = feature_name.gsub(/[-_]/, ' ')
  header = "#{feature} (#{feature_name})"

  message = "#{header}: #{message}"
end

`git commit #{options.join(' ')} -m \"#{message}\"`
